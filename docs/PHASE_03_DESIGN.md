# Phase 3: 設計 (Design)

## 目的

システム全体の設計を決定し、実装の指針を定める。

## なぜ必要か

### ここでコードを書くと詳細に引きずられる

- 実装の細かい部分に気を取られる
- 全体像が見えなくなる
- 本質的な設計判断ができなくなる

### 設計を複数ファイルに分けると管理が煩雑

- どこに何が書いてあるか分からなくなる
- 矛盾が発生しやすい
- レビュー時に全体像を把握できない

### 作成順序を間違えると手戻りが多い

- GUI先行 → 後からDB構造変更 → 全部作り直し
- 浅い層から作る → 深い層の制約を後から知る → 大幅修正
- 深い層から作る → 手戻り最小化

## 何をするか

### 1. コードは書かない

- 設計書、構成図、フロー図のみ
- 実装の詳細はここでは決めない
- 設計はコードを書くための場所ではない

### 2. 1ファイルにすべて書く

- 全体像を1箇所で把握
- 矛盾を防ぐ
- 1ファイルで簡潔に

### 3. 作業工程はタスク分解フェーズに任せる

- ここでは「何を作るか」に集中
- 「どう作るか」はタスク分解で
- 行数の無駄とレビューによる修正で1箇所の負担を減らす

### 4. 設計は軽く詰める

- 難しいアルゴリズムはここで詰めない
- ロジックの穴を増やさないため
- 複雑にしないため

### 5. 作成順序: DB → バックエンド → API → GUI/CLI

- 深い層から作る
- 「後から〇〇が必要だった」を防ぐ
- 手戻りを最小化

## 失敗例と対策

### 失敗例

- GUI画面から設計開始
- 後からDB設計を変更
- APIの戻り値も変更
- フロントエンドも全修正
- 結果: 全部作り直し

### 対策

- DBスキーマから設計
- データモデルを確定
- バックエンドロジックを設計
- API仕様を決定
- 最後にGUI設計
- 結果: 手戻り最小

## チェックリスト

### 完了基準

- [ ] コードが含まれていないか？
- [ ] 1ファイルにまとまっているか？
- [ ] DB → バックエンド → API → GUI/CLI の順序か？
- [ ] アルゴリズムを詳細に書きすぎていないか？
- [ ] 全体像が明確か？

### 出力物

- 設計書（1ファイル）
  - DBスキーマ
  - バックエンドアーキテクチャ
  - API仕様
  - GUI/CLIデザイン

## 次のフェーズへの移行条件

- チェックリストの全項目が完了している
- 設計が1ファイルで完成している
- 全体像が明確になっている

## 参考リソース

- [システム設計の基礎](https://github.com/donnemartin/system-design-primer)
- [API設計のベストプラクティス](https://github.com/microsoft/api-guidelines)
